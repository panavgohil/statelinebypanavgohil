<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stateline Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root { --bg:#0f172a; --card:rgba(30, 41, 59, 0.7); --text:#f1f5f9; --accent:#3b82f6; --border:rgba(255,255,255,0.1); }
  body { margin:0; font-family:'Inter', system-ui; background:var(--bg); color:var(--text); min-height:100vh; }
  
  /* --- HEADER --- */
  header { 
    background: rgba(15, 23, 42, 0.95); 
    padding: 0 40px; 
    height: 80px; 
    border-bottom: 1px solid var(--border); 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    position: sticky; 
    top: 0; 
    z-index: 50; 
    backdrop-filter: blur(10px); 
  }
  
  .brand-group { display: flex; flex-direction: column; justify-content: center; }
  .brand { font-family: 'Playfair Display', serif; font-weight: 900; font-size: 24px; text-transform: uppercase; color: white; letter-spacing: 2px; line-height: 1; }
  .credit { font-size: 10px; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 2px; margin-top: 4px; }
  
  .right-area { display: flex; align-items: center; gap: 25px; }
  .greeting-box { text-align: right; }
  .greeting-label { font-size: 10px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }
  .user-name { font-family: 'Playfair Display', serif; font-size: 18px; color: white; font-weight: 700; }
  .divider { height: 30px; width: 1px; background: var(--border); }

  .header-btn { background:rgba(59, 130, 246, 0.1); color:var(--accent); border:1px solid var(--accent); padding: 8px 16px; border-radius: 8px; font-weight: 600; transition: 0.2s; cursor: pointer; font-size: 13px; } 
  .header-btn:hover { background: var(--accent); color: white; }
  
  .settings-btn { background:transparent; border:1px solid #475569; color:#94a3b8; padding: 8px 16px; border-radius: 8px; cursor: pointer; transition:0.2s; font-size: 13px; font-weight: 500; } 
  .settings-btn:hover { border-color:white; color:white; }

  /* --- MENU --- */
  .profile-menu { position:absolute; top:70px; right:20px; width:280px; background:#1e293b; border:1px solid var(--border); border-radius:16px; padding:20px; display:none; box-shadow:0 20px 50px rgba(0,0,0,0.5); z-index:100; backdrop-filter: blur(10px); }
  .profile-menu.show { display:block; animation: fadeIn 0.2s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
  .menu-item { margin-bottom:15px; }
  .menu-label { font-size:12px; color:#94a3b8; margin-bottom:6px; display:block; font-weight: 600; }
  .menu-input { width:100%; padding:10px; background:rgba(15, 23, 42, 0.6); border:1px solid var(--border); color:white; border-radius:8px; font-size:13px; outline:none; transition: border-color 0.2s; }
  .menu-input:focus { border-color: var(--accent); }
  .pass-group { display:flex; gap:5px; }
  .toggle-vis { background:none; border:none; color:#94a3b8; cursor:pointer; font-size:14px; padding: 0 5px; } .toggle-vis:hover { color: white; }
  
  /* --- LAYOUT --- */
  .container { max-width:1200px; margin:20px auto; padding:0 15px; display:flex; gap:20px; flex-wrap:wrap; }
  .main { flex:3; min-width:300px; }
  .sidebar { flex:1; min-width:280px; }
  .card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:25px; margin-bottom:20px; box-shadow:0 4px 20px rgba(0,0,0,0.1); }
  h2, h3 { margin-top:0; color:white; font-family: 'Playfair Display', serif; letter-spacing: 0.5px; } h2 { font-size: 22px; } h3 { font-size: 18px; color: var(--accent); }
  
  /* --- STATS & LISTS --- */
  .stat-row { margin-bottom:15px; } .stat-head { display:flex; justify-content:space-between; font-size:14px; margin-bottom:6px; font-weight: 500; } .progress-bg { background:rgba(255,255,255,0.1); height:10px; border-radius:5px; overflow:hidden; } .progress-fill { height:100%; transition:width 0.5s ease; border-radius:5px; }
  .p-green { background:#22c55e; } .p-orange { background:#f59e0b; } .p-red { background:#ef4444; }
  .week-row { display:flex; border-bottom:1px solid var(--border); padding:12px 0; align-items:center; } .week-row:last-child { border-bottom:none; } .week-day { width:100px; font-weight:600; color:#94a3b8; font-size:14px; } .week-subjects { flex:1; display:flex; flex-wrap:wrap; gap:8px; }
  .sub-tag { background:#334155; padding:4px 10px; border-radius:15px; font-size:12px; border:1px solid var(--border); font-weight: 500; } .sub-tag.long { border-color:#3b82f6; color:#bfdbfe; }
  
  /* --- SCHEDULE BUTTONS (Updated to 6 Buttons) --- */
  .subject-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap:15px; margin-top:20px; }
  .sub-btn { background:#1e293b; color:white; padding:15px; border:1px solid var(--border); border-radius:12px; display:flex; flex-direction:column; gap:10px; min-height:100px; transition:0.2s; position:relative; overflow:hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); } .sub-btn:hover { background:#334155; border-color:var(--accent); transform: translateY(-2px); }
  .sub-btn.long { grid-column: span 1; background:linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border:1px solid #3b82f6; } .sub-btn.long::after { content:"2 HR"; position:absolute; top:10px; right:10px; font-size:10px; background:#3b82f6; padding:3px 6px; border-radius:4px; font-weight:700; letter-spacing: 0.5px; }
  
  .card-top { display:flex; justify-content:space-between; align-items:center; width:100%; } 
  .reorder-controls { display:flex; gap:2px; } 
  .move-btn { background:rgba(0,0,0,0.3); color:#94a3b8; padding:4px 8px; font-size:10px; border:1px solid var(--border); border-radius:6px; cursor:pointer; height:fit-content; transition: 0.2s; } .move-btn:hover { background:white; color:black; border-color: white; }
  
  .actions { display:flex; gap:5px; margin-top:auto; flex-wrap:wrap; } 
  .act-btn { flex:1; padding:8px 0; font-size:12px; border-radius:8px; border:none; color:white; font-weight:700; cursor: pointer; transition: 0.2s; text-transform: uppercase; min-width: 40px; } 
  .act-btn:hover { opacity: 0.9; transform: scale(1.05); }
  
  .bg-green { background:#16a34a; } .bg-red { background:#dc2626; } .bg-orange { background:#ea580c; } 
  .bg-blue { background:#2563eb; } .bg-cyan { background:#0891b2; } .bg-purple { background:#9333ea; }
  
  /* --- LEGEND --- */
  .legend-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; }
  .legend-item { display: flex; align-items: center; gap: 10px; font-size: 12px; color: #cbd5e1; }
  .legend-dot { width: 12px; height: 12px; border-radius: 4px; }

  /* --- FORMS --- */
  .editor-box { background:#1e293b; padding:20px; border-radius:12px; border:1px solid var(--border); margin-bottom:20px; } .hidden { display:none; }
  .reschedule-box { background:rgba(147, 51, 234, 0.15); border:1px solid rgba(147, 51, 234, 0.4); padding:15px; border-radius:10px; margin-top:15px; }
  label { display:block; font-size:12px; color:#94a3b8; margin:12px 0 6px; font-weight: 600; }
  input, select { width:100%; padding:12px; background:rgba(0,0,0,0.2); border:1px solid var(--border); color:white; border-radius:10px; box-sizing:border-box; outline: none; transition: 0.3s; } input:focus, select:focus { border-color: var(--accent); background: rgba(0,0,0,0.3); }
  .btn-full { width:100%; margin-top:15px; padding:12px; font-size:14px; cursor:pointer; border:none; border-radius:10px; transition:0.2s; font-weight: 600; display: flex; align-items: center; justify-content: center; } .btn-full:active { transform:scale(0.98); } .btn-full:hover { opacity: 0.9; }
  .btn-save { background:linear-gradient(to right, #16a34a, #059669); color:white; margin-top:15px; }
  .btn-logout { background:linear-gradient(to right, #ef4444, #dc2626); color:white; margin-top:10px; }
  
  #toast { position:fixed; bottom:30px; left:50%; transform:translateX(-50%); background:white; color:black; padding:12px 24px; border-radius:50px; font-weight:600; display:none; z-index:100; box-shadow:0 10px 30px rgba(0,0,0,0.5); }
  #syncStatus { font-size:11px; margin-right:15px; color:#94a3b8; font-style:italic; display: flex; align-items: center; }

  @media (max-width: 768px) {
    header { height: auto; padding: 20px; flex-direction: column; align-items: flex-start; gap: 20px; }
    .right-area { width: 100%; justify-content: space-between; }
    .greeting-box { text-align: left; }
    .divider { display: none; }
    .subject-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<script>window.onerror = function(msg, url, line) { alert("Code Error: " + msg + "\nLine: " + line); };</script>

<header>
  <div class="brand-group">
    <div class="brand">Stateline</div>
    <div class="credit">By Panav Gohil</div>
  </div>

  <div class="right-area">
    <div class="greeting-box">
      <div class="greeting-label">Welcome back</div>
      <div class="user-name">Hi, <span id="dispName">Guest</span></div>
    </div>

    <div class="divider"></div>

    <div style="display:flex; align-items:center; gap:10px">
      <span id="syncStatus"></span>
      <button onclick="toggleEditor()" class="header-btn">‚úé Schedule</button>
      <button onclick="toggleProfile()" class="settings-btn">‚öô Settings</button>
    </div>

    <div class="profile-menu" id="profileMenu">
      <h4 style="margin:0 0 15px; border-bottom:1px solid #334155; padding-bottom:10px; color:white; font-family:'Playfair Display',serif;">Account Settings</h4>
      <div class="menu-item">
        <label class="menu-label">Branch</label>
        <input class="menu-input" id="profBranch">
      </div>
      <div class="menu-item">
        <label class="menu-label">Password</label>
        <div class="pass-group">
          <input class="menu-input" id="profPass" type="password">
          <button class="toggle-vis" onclick="togglePassVis()">üëÅÔ∏è</button>
        </div>
      </div>
      <button class="btn-full btn-save" onclick="updateProfile()">Update Details</button>
      <button class="btn-full btn-logout" onclick="logout()">Log Out</button>
    </div>
  </div>
</header>

<div class="container">
  <div class="main">
    <div class="card"><h3>Attendance Statistics</h3><p style="font-size:12px;color:#94a3b8;margin-bottom:15px;">Weighted: 1hr = 1pt, 2hr = 2pts.</p><div id="statsContainer"><div style="text-align:center;padding:10px;color:#64748b;">Loading stats...</div></div></div>
    <div id="editor" class="card hidden">
      <h3>Manage Subjects</h3>
      <div class="editor-box">
        <label>Day</label><select id="edDay"><option>Monday</option><option>Tuesday</option><option>Wednesday</option><option>Thursday</option><option>Friday</option></select>
        <label>Subject</label><input id="edName" placeholder="e.g. NAS">
        <label>Duration</label><select id="edDur"><option value="1">1 Hour</option><option value="2">2 Hours</option></select>
        <button class="btn-full" onclick="addSubject()" style="background:linear-gradient(to right, #16a34a, #059669); color:white;">+ Add to Schedule</button>
      </div>
      <button onclick="clearSchedule()" style="color:#ef4444; background:none; border:1px solid #ef4444; width:auto; padding:8px 12px; border-radius: 8px;">Reset All Data</button>
    </div>
    
    <div class="card">
      <div style="display:flex; justify-content:space-between; margin-bottom:15px;"><h2 id="dayHeader" style="margin:0; font-family:'Inter', sans-serif; font-size: 20px;">Today</h2><span style="font-size:12px;color:#94a3b8; font-weight: 600;" id="dateDisp"></span></div>
      <div id="subjectList" class="subject-grid"></div>
      <div id="emptyMsg" style="text-align:center; padding:40px; display:none; color:#94a3b8">No classes today.</div>
    </div>
    
    <div class="card">
      <h3 style="font-size:14px; margin-bottom:15px;">Attendance Key</h3>
      <div class="legend-grid">
        <div class="legend-item"><div class="legend-dot bg-green"></div> <span>P - Attended</span></div>
        <div class="legend-item"><div class="legend-dot bg-red"></div> <span>B - Bunked</span></div>
        <div class="legend-item"><div class="legend-dot bg-orange"></div> <span>A - Absent</span></div>
        <div class="legend-item"><div class="legend-dot bg-blue"></div> <span>CT - Cancelled by Teacher</span></div>
        <div class="legend-item"><div class="legend-dot bg-cyan"></div> <span>CR - Cancelled by CR</span></div>
        <div class="legend-item"><div class="legend-dot bg-purple"></div> <span>R - Rescheduled</span></div>
      </div>
    </div>

    <div class="card"><h3>Weekly Schedule</h3><div id="weeklyContainer"></div></div>

  </div>
  <div class="sidebar">
    <div class="card">
      <h3>Manual Entry</h3>
      <label>Date</label><input type="date" id="mDate">
      <label>Day</label><select id="mDay"><option>Monday</option><option>Tuesday</option><option>Wednesday</option><option>Thursday</option><option>Friday</option></select>
      <label>Subject</label><input id="mSubject" list="mySubjects" placeholder="Select Subject"><datalist id="mySubjects"></datalist>
      <label>Duration</label><select id="mWeight"><option value="1">1 Hour</option><option value="2">2 Hours</option></select>
      <label>Status</label><select id="mStatus" onchange="toggleRescheduleBox()"><option>Attended</option><option>Bunked</option><option>Absent</option><option>Cancelled by Teacher</option><option>Cancelled by CR</option><option>Rescheduled</option></select>
      <div id="rescheduleBox" class="reschedule-box hidden">
        <label style="color:#e879f9">New Date</label><input type="date" id="rDate">
        <label style="color:#e879f9">New Time</label><input type="time" id="rTime">
      </div>
      <label>Remark (Optional)</label><input id="mRemark" placeholder="e.g. Extra class">
      <button class="btn-full" onclick="manual()" style="background:linear-gradient(to right, var(--accent), #2563eb); color:white;">Add Entry</button>
      <div style="margin:25px 0; border-top:1px solid var(--border);"></div>
      <button class="btn-full" onclick="exportMyData()" style="background:#1e293b; border: 1px solid var(--accent); color: var(--accent);">üì• Download Attendance Logs</button>
    </div>
  </div>
</div>
<div id="toast">Saved!</div>

<script>
// =================================================================
// REPLACE WITH YOUR URL
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzJpA1JfJcUGf4TJWGaSHHIt0kHTBqEPB3wsWsZKyYZFeA-QbtTFOafitA7wfDmxjCw9w/exec"; 
// =================================================================

const user = localStorage.getItem("userName") || "Guest";
const roll = localStorage.getItem("userRoll");
const branch = localStorage.getItem("userBranch");
const pass = localStorage.getItem("userPass");

if(!roll) { window.location.href = "login.html"; }

document.getElementById("dispName").innerText = user.split(" ")[0]; 
document.getElementById("dateDisp").innerText = new Date().toLocaleDateString();

let mySchedule = JSON.parse(localStorage.getItem("mySchedule")) || { Monday:[], Tuesday:[], Wednesday:[], Thursday:[], Friday:[] };
const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
const today = days[new Date().getDay()];
document.getElementById("dayHeader").innerText = today;

init();

function init() {
  updateSubjectList(); renderSchedule(); renderWeekly(); fetchStats();
  document.getElementById("profBranch").value = branch || "";
  document.getElementById("profPass").value = pass || "";
}

function toggleProfile() { document.getElementById("profileMenu").classList.toggle("show"); }
function togglePassVis() { const x = document.getElementById("profPass"); x.type = x.type === "password" ? "text" : "password"; }

async function updateProfile() {
  const newBranch = document.getElementById("profBranch").value;
  const newPass = document.getElementById("profPass").value;
  const btn = document.querySelector(".btn-save");
  btn.innerText = "Updating..."; btn.disabled = true;
  fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify({ type: "update-profile", roll: roll, branch: newBranch, password: newPass }) })
  .then(r => r.json()).then(res => {
    if(res.status === "success") { localStorage.setItem("userBranch", newBranch); localStorage.setItem("userPass", newPass); alert("Details Updated!"); location.reload(); } else { alert("Error: " + res.message); }
    btn.innerText = "Update Details"; btn.disabled = false;
  }).catch(e => { alert("Connection Error."); btn.innerText = "Update Details"; btn.disabled = false; });
}

function syncSchedule() { document.getElementById("syncStatus").innerHTML = "<span>Syncing...</span>"; fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify({ type: "save-schedule", roll: roll, schedule: JSON.stringify(mySchedule) }) }).then(r=>r.json()).then(res=>{ document.getElementById("syncStatus").innerHTML = res.status==="success" ? "<span style='color:#86efac'>Saved ‚úî</span>" : "<span style='color:#fca5a5'>Error ‚ö†</span>"; }); }
async function sendData(day, subject, status, remark, weight, dateOverride) { const toast = document.getElementById("toast"); toast.innerText = "Saving..."; toast.style.display = "block"; try { const res = await fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify({ name: user, roll: roll, date: dateOverride ? new Date(dateOverride).toLocaleDateString() : new Date().toLocaleDateString(), day: day, subject: subject, status: status, remark: remark, weight: parseInt(weight) }) }); const data = await res.json(); if(data.status === "success") { toast.innerText = "Saved!"; await fetchStats(); setTimeout(() => toast.style.display="none", 2000); } else throw new Error(data.message); } catch(e) { toast.innerText = "Error!"; setTimeout(() => toast.style.display="none", 3000); } }

// UPDATED: Buttons now use Initials (P, B, A, CT, CR, R) mapping to full statuses
function renderSchedule() { 
  const container = document.getElementById("subjectList"); container.innerHTML = ""; 
  const subjects = mySchedule[today] || []; 
  if(subjects.length === 0) { document.getElementById("emptyMsg").style.display = "block"; } else { document.getElementById("emptyMsg").style.display = "none"; 
    subjects.forEach((sub, index) => { 
      const cls = sub.duration == 2 ? "sub-btn long" : "sub-btn"; 
      const showUp = index > 0 ? `<button class="move-btn" onclick="moveSubject(${index}, -1)">‚ñ≤</button>` : ''; 
      const showDown = index < subjects.length - 1 ? `<button class="move-btn" onclick="moveSubject(${index}, 1)">‚ñº</button>` : ''; 
      const html = `
        <div class="${cls}">
          <div class="card-top">
            <div style="font-weight:bold;font-size:15px;">${sub.name}</div>
            <div class="reorder-controls">${showUp}${showDown}</div>
          </div>
          <div class="actions">
            <button class="act-btn bg-green" title="Attended" onclick="mark('${sub.name}','Attended',${sub.duration})">P</button>
            <button class="act-btn bg-red" title="Bunked" onclick="mark('${sub.name}','Bunked',${sub.duration})">B</button>
            <button class="act-btn bg-orange" title="Absent" onclick="mark('${sub.name}','Absent',${sub.duration})">A</button>
            <button class="act-btn bg-blue" title="Cancelled by Teacher" onclick="mark('${sub.name}','Cancelled by Teacher',0)">CT</button>
            <button class="act-btn bg-cyan" title="Cancelled by CR" onclick="mark('${sub.name}','Cancelled by CR',0)">CR</button>
            <button class="act-btn bg-purple" title="Rescheduled" onclick="mark('${sub.name}','Rescheduled',${sub.duration},'Rescheduled')">R</button>
          </div>
        </div>`; 
      container.innerHTML += html; 
    }); 
  } 
}

function renderWeekly() { const container = document.getElementById("weeklyContainer"); container.innerHTML = ""; ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"].forEach(day => { const subjects = mySchedule[day] || []; let subHtml = subjects.length === 0 ? `<span style="font-size:12px;color:#64748b;font-style:italic;">No classes</span>` : subjects.map(s => `<span class="${s.duration==2?'sub-tag long':'sub-tag'}">${s.name}</span>`).join(""); container.innerHTML += `<div class="week-row"><div class="week-day">${day}</div><div class="week-subjects">${subHtml}</div></div>`; }); }
async function fetchStats() { try { const res = await fetch(`${SCRIPT_URL}?type=history&roll=${encodeURIComponent(roll)}`); const history = await res.json(); const stats = {}; history.forEach(entry => { const sub = entry.subject; const weight = parseInt(entry.weight) || 1; if (!stats[sub]) stats[sub] = { attended: 0, total: 0 }; if (entry.status === "Attended") { stats[sub].attended += weight; stats[sub].total += weight; } else if (entry.status === "Absent" || entry.status === "Bunked") { stats[sub].total += weight; } }); renderStats(stats); } catch (e) { document.getElementById("statsContainer").innerHTML = '<div style="text-align:center;font-size:12px;color:#ef4444">Failed to load stats</div>'; } }
function renderStats(stats) { const container = document.getElementById("statsContainer"); container.innerHTML = ""; if (Object.keys(stats).length === 0) { container.innerHTML = '<div style="text-align:center;font-size:12px;color:#64748b">No data yet</div>'; return; } for (const [sub, data] of Object.entries(stats)) { if (data.total === 0) continue; const pct = Math.round((data.attended / data.total) * 100); let color = pct >= 75 ? "p-green" : (pct >= 50 ? "p-orange" : "p-red"); container.innerHTML += `<div class="stat-row"><div class="stat-head"><span>${sub}</span><span>${pct}% <span style="opacity:0.5;font-size:11px;">(${data.attended}/${data.total}) pts</span></span></div><div class="progress-bg"><div class="progress-fill ${color}" style="width:${pct}%"></div></div></div>`; } }
function updateSubjectList() { const set = new Set(); Object.values(mySchedule).forEach(arr => arr.forEach(s => set.add(s.name))); const datalist = document.getElementById("mySubjects"); datalist.innerHTML = ""; set.forEach(name => { const opt = document.createElement("option"); opt.value = name; datalist.appendChild(opt); }); }
function moveSubject(index, direction) { const dayList = mySchedule[today]; if (!dayList) return; [dayList[index], dayList[index + direction]] = [dayList[index + direction], dayList[index]]; localStorage.setItem("mySchedule", JSON.stringify(mySchedule)); syncSchedule(); renderSchedule(); renderWeekly(); }
function toggleEditor() { document.getElementById("editor").classList.toggle("hidden"); }
function toggleRescheduleBox() { const status = document.getElementById("mStatus").value; document.getElementById("rescheduleBox").classList.toggle("hidden", status !== "Rescheduled"); }
function addSubject() { const day = document.getElementById("edDay").value; const name = document.getElementById("edName").value.trim(); const dur = document.getElementById("edDur").value; if(!name) return alert("Enter subject name"); mySchedule[day].push({ name: name, duration: parseInt(dur) }); localStorage.setItem("mySchedule", JSON.stringify(mySchedule)); syncSchedule(); updateSubjectList(); renderWeekly(); if(day === today) renderSchedule(); }
function clearSchedule() { if(confirm("Delete all subjects?")) { localStorage.removeItem("mySchedule"); mySchedule = { Monday:[], Tuesday:[], Wednesday:[], Thursday:[], Friday:[] }; syncSchedule(); location.reload(); } }
function mark(subject, status, weight, remark="") { sendData(today, subject, status, remark, weight); }
function manual() { const d = document.getElementById("mDate").value; if(!d) return alert("Select date"); const sub = document.getElementById("mSubject").value; if(!sub) return alert("Enter subject"); const weight = document.getElementById("mWeight").value; const status = document.getElementById("mStatus").value; let rem = document.getElementById("mRemark").value; if(status === "Rescheduled") { const rDate = document.getElementById("rDate").value; const rTime = document.getElementById("rTime").value; if(rDate) rem += ` (To: ${rDate} ${rTime})`; } const btn = document.querySelector(".sidebar .btn-full"); const oldText = btn.innerText; btn.innerText = "Processing..."; btn.disabled = true; sendData(document.getElementById("mDay").value, sub, status, rem, weight, d).then(() => { btn.innerText = oldText; btn.disabled = false; document.getElementById("mSubject").value = ""; document.getElementById("mRemark").value = ""; }); }
function exportMyData() { window.open(`${SCRIPT_URL}?roll=${encodeURIComponent(roll)}`, "_blank"); }
function logout() { if(confirm("Log out?")) { localStorage.clear(); window.location.href = "login.html"; } }
</script>
</body>
</html>
